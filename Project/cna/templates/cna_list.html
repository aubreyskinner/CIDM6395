{% extends 'base.html' %}

{% block content %}
<h1 class="page-title">Available CNAs</h1>

<!-- Filter Form -->
<div class="filter-form">
  <form method="GET" action="{% url 'cna_list' %}">
    <div class="form-group">
      <label for="location">Location:</label>
      <input type="text" id="location" name="location" placeholder="Search by location" value="{{ request.GET.location }}">
    </div>
    <div class="form-group">
      <label for="hourly_rate">Max Hourly Rate ($):</label>
      <input type="number" id="hourly_rate" name="hourly_rate" placeholder="Max hourly rate" value="{{ request.GET.hourly_rate }}">
    </div>
    <button type="submit" class="submit-btn">Filter</button>
  </form>
</div>

<!-- CNA Listings -->
<div class="cna-container">
  {% for cna in cnas %}
    <div class="cna-card">
      <h2>{{ cna.first_name }} {{ cna.last_name }}</h2>
      <p><strong>Email:</strong> {{ cna.email }}</p>
      <p><strong>Phone:</strong> {{ cna.phone_number }}</p>
      <p><strong>Hourly Rate:</strong> ${{ cna.hourly_rate }}</p>
      <p><strong>Experience:</strong> {{ cna.experience }}</p>
      <p><strong>Location:</strong> {{ cna.location }}</p>
      <p><strong>Availability:</strong> {{ cna.availability|json_script:"availability" }}</p>

      {% if cna.review_count > 0 %}
        <p><strong>Average Rating:</strong> {{ cna.avg_rating|floatformat:1 }}â˜… ({{ cna.review_count }} review{{ cna.review_count|pluralize }})</p>
      {% else %}
        <p><em>No reviews yet</em></p>
      {% endif %}

      <!-- Action Buttons -->
      <div style="margin-top: 15px;">
        <a href="{% url 'contact_cna' cna.id %}" class="cta-btn" style="display:inline-block; margin-bottom:10px;">Contact This CNA</a>
        <a href="{% url 'leave_review' cna.id %}" class="cta-btn" style="display:inline-block;">Leave a Review</a>
      </div>
    </div>
  {% empty %}
    <p>No CNAs are currently available.</p>
  {% endfor %}
</div>
{% endblock %}
